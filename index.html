<!DOCTYPE html>
<html>
<head>
<title>Thrissur Live Bus Tracker</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<style>
/* Reset & fonts */
* { box-sizing: border-box; margin:0; padding:0; }
body {
    font-family: 'Poppins', sans-serif;
    min-height:100vh;
    display:flex; justify-content:center; align-items:flex-start;
    padding: 40px 10px;
    background: linear-gradient(to bottom, rgba(0,123,255,0.3), rgba(255,255,255,0.3)), 
                url('https://images.unsplash.com/photo-1618145293368-8f6e3fc914b4?auto=format&fit=crop&w=1350&q=80') no-repeat center center fixed;
    background-size: cover;
}

/* Container */
.container {
    width:100%; max-width:720px;
    background: rgba(255,255,255,0.95);
    border-radius:25px; padding:30px 25px;
    box-shadow:0 15px 40px rgba(0,0,0,0.3);
    backdrop-filter: blur(6px);
    animation: fadeIn 0.8s ease;
}

/* Heading */
h3 { text-align:center; margin-bottom:30px; font-size:2em; color:#007BFF; letter-spacing:1px; }

/* Inputs */
.input-group { position: relative; margin-bottom:20px; }
input {
    width:100%; padding:14px 16px; font-size:16px; border-radius:12px; border:1px solid #ccc;
    transition: all 0.3s;
}
input:focus { outline:none; border-color:#007BFF; box-shadow:0 0 10px rgba(0,123,255,0.3); }

.dropdown {
    position:absolute; width:100%; background:#fff; border:1px solid #ccc;
    max-height:180px; overflow-y:auto; display:none; border-radius:10px; z-index:1000;
}
.dropdown div { padding:10px 14px; cursor:pointer; transition: background 0.2s; }
.dropdown div:hover { background:#f0f8ff; }

/* Button */
button {
    width:100%; padding:14px; font-size:16px; border:none; border-radius:12px;
    background: linear-gradient(90deg,#007BFF,#00CFFF);
    color:white; font-weight:bold; cursor:pointer; margin-bottom:20px;
    transition: all 0.3s;
}
button:hover { background: linear-gradient(90deg,#0056b3,#00a1c4); }

/* Bus Cards */
.bus-card {
    display:flex; align-items:center; justify-content:space-between;
    background: linear-gradient(135deg,#ffffff,#e0f7fa);
    border-radius:20px; padding:18px 22px; margin-bottom:18px;
    box-shadow:0 8px 25px rgba(0,0,0,0.1); position:relative;
    animation: fadeIn 0.6s ease;
}
@keyframes fadeIn { 0% {opacity:0; transform:translateY(20px);} 100% {opacity:1; transform:translateY(0);} }

.bus-info { display:flex; align-items:center; }
.bus-info img { width:50px; height:50px; margin-right:15px; animation: floatBus 2s ease-in-out infinite alternate; }
@keyframes floatBus { 0% {transform:translateY(0);} 100% {transform:translateY(-5px);} }

.bus-details { display:flex; flex-direction:column; }
.bus-details span { font-weight:600; font-size:16px; }

.times { display:flex; flex-direction:column; align-items:flex-end; }
.delayed {
    color:#ff3d00; font-weight:700; font-size:14px;
    animation: blink 1.2s infinite;
}
.ontime { color:#00bfa5; font-weight:600; font-size:14px; }
@keyframes blink { 0%,50%,100% {opacity:1;} 25%,75% {opacity:0.3;} }

.no-bus { text-align:center; color:#ff3d00; font-weight:bold; margin-top:15px; font-size:16px; }

/* Responsive */
@media(max-width:500px){
    .bus-card { flex-direction:column; align-items:flex-start; }
    .times { align-items:flex-start; margin-top:8px; }
}
</style>
</head>
<body>
<div class="container">
    <h3>Thrissur Live Bus Tracker</h3>

    <div class="input-group">
        <input type="text" id="source" placeholder="Enter Source">
        <div id="sourceDropdown" class="dropdown"></div>
    </div>
    <div class="input-group">
        <input type="text" id="destination" placeholder="Enter Destination">
        <div id="destinationDropdown" class="dropdown"></div>
    </div>
    <button onclick="searchRoute()">Search</button>
    <div id="busResult"></div>
</div>

<script>
const places = ["Thrissur","Guruvayur","Ollur","Chalakudy","Kodungallur","Irinjalakuda",
"Wadakkanchery","Punkunnam","Kunnamkulam","Athani","Cherpu","Mannuthy","Pavaratty",
"Viyyur","West Fort","East Fort"];

const buses = [
    { "busNo":"101","boarding":"Thrissur","ending":"Chalakudy","stops":["Thrissur","Ollur","Chalakudy"],"timings":["08:00","08:20","08:40"],"currentTimings":["08:05","08:25","08:50"] },
    { "busNo":"102","boarding":"Thrissur","ending":"Kodungallur","stops":["Thrissur","Punkunnam","Kodungallur"],"timings":["08:15","08:35","09:00"],"currentTimings":["08:15","08:40","09:10"] },
    { "busNo":"103","boarding":"Guruvayur","ending":"Irinjalakuda","stops":["Guruvayur","Thrissur","Irinjalakuda"],"timings":["07:50","08:30","09:00"],"currentTimings":["07:55","08:35","09:05"] }
];

function setupAutocomplete(inputId, dropdownId){
    const input=document.getElementById(inputId);
    const dropdown=document.getElementById(dropdownId);
    input.addEventListener("focus",()=>showDropdown(places));
    input.addEventListener("input",function(){
        const val=this.value.toLowerCase();
        const filtered=places.filter(p=>p.toLowerCase().includes(val));
        showDropdown(filtered);
    });
    function showDropdown(list){
        dropdown.innerHTML="";
        if(list.length===0){ dropdown.style.display="none"; return; }
        list.forEach(place=>{
            const div=document.createElement("div");
            div.textContent=place;
            div.onclick=()=>{ input.value=place; dropdown.style.display="none"; };
            dropdown.appendChild(div);
        });
        dropdown.style.display="block";
    }
    document.addEventListener("click",e=>{
        if(!input.contains(e.target)&&!dropdown.contains(e.target)) dropdown.style.display="none";
    });
}
setupAutocomplete("source","sourceDropdown");
setupAutocomplete("destination","destinationDropdown");

function searchRoute(){
    const source=document.getElementById("source").value;
    const destination=document.getElementById("destination").value;
    const resultDiv=document.getElementById("busResult");
    resultDiv.innerHTML="";
    if(!source || !destination){ alert("Enter both source & destination"); return; }
    if(source===destination){ alert("Source and destination cannot be the same"); return; }

    const available=[];
    buses.forEach(bus=>{
        const s=bus.stops.indexOf(source);
        const d=bus.stops.indexOf(destination);
        if(s!==-1 && d!==-1 && s<d){
            available.push({
                busNo:bus.busNo, boarding:bus.boarding, ending:bus.ending,
                srcScheduled:bus.timings[s], destScheduled:bus.timings[d],
                srcCurrent:bus.currentTimings?bus.currentTimings[s]:bus.timings[s],
                destCurrent:bus.currentTimings?bus.currentTimings[d]:bus.timings[d]
            });
        }
    });

    if(available.length===0){ resultDiv.innerHTML=`<div class="no-bus">No buses found for this route</div>`; return; }

    available.forEach(bus=>{
        const srcClass = bus.srcScheduled!==bus.srcCurrent?"delayed":"ontime";
        const destClass = bus.destScheduled!==bus.destCurrent?"delayed":"ontime";

        const busCard=document.createElement("div");
        busCard.className="bus-card";
        busCard.innerHTML=`
            <div class="bus-info">
                <img src="https://img.icons8.com/fluency/48/bus.png" alt="bus"/>
                <div class="bus-details">
                    <span>Bus ${bus.busNo}</span>
                    <span>${bus.boarding} â†’ ${bus.ending}</span>
                </div>
            </div>
            <div class="times">
                <span class="${srcClass}">Source: ${bus.srcCurrent}${bus.srcScheduled!==bus.srcCurrent ? ' (Sched: '+bus.srcScheduled+')':''}</span>
                <span class="${destClass}">Dest: ${bus.destCurrent}${bus.destScheduled!==bus.destCurrent ? ' (Sched: '+bus.destScheduled+')':''}</span>
            </div>
        `;
        resultDiv.appendChild(busCard);
    });
}
</script>
</body>
</html>